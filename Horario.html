<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horario de Clases - Profesor: Jorge Luis Abreu, M.A.</title>
    <link rel="stylesheet" href="styles.css">
	<link rel="icon" type="image/png" href="icon/icon.png">
</head>
<body>
 <header class="navbar">
    <div class="navbar-content">
        <div class="logo"><a href="index.html">J. L. Abreu | Portafolio Docente</a></div>
        <nav>
            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li class="dropdown">
                    <a href="#">Módulos</a>
                    <ul class="submenu">
                        <li><a href="DDBD.html">DDBD</a></li>
                        <li><a href="DPWRM.html">DPWRM</a></li>
                        <li><a href="TecDig.html">Tec.Dig</a></li>
                        <li><a href="DASI.html">DASI</a></li>
                        <li><a href="IMASI.html">IMASI</a></li>
                        <li><a href="Talleres.html">Talleres</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#">Herramientas</a>
                    <ul class="submenu">
                        <li><a href="Horario.html">Horario</a></li>
                        <li><a href="gestion_actividad.html">Actividades</a></li>
                        <li><a href="ruleta.html">Ruleta</a></li>
						<li><a href="Preguntas.html">Ruleta de Preguntas</a></li>
						<li><a href="Planificacion-Diaria.html">Planificación Diaria</a></li>						
                    </ul>
                </li>
                <li><a href="cv_soporte.html">CV/Soporte</a></li>
            </ul>
        </nav>
    </div>
</header>
    <div class="container">
        <h1>Horario Semanal de Clases</h1>
        <p class="metadata">Profesor: Jorge Luis Abreu, M.A. | Generado: 27/08/2025</p>

        <div id="countdown-banner" class="countdown-banner">
            Preparando la agenda...
        </div>

        <div class="table-responsive-container"> <table class="horario-clases">
                <thead>
                    <tr>
                        <th>Día</th>
                        <th>1<br>8:00-8:50</th>
                        <th>2<br>8:50-9:40</th>
                        <th>3<br>9:40-10:30</th>
                        <th>Recreo<br>10:30-11:00</th>
                        <th>4<br>11:00-11:45</th>
                        <th>5<br>11:45-12:30</th>
                        <th>Almuerzo<br>12:30-13:30</th>
                        <th>6<br>13:30-14:20</th>
                        <th>7<br>14:20-15:10</th>
                        <th>8<br>15:10-16:00</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="dia">Lun</td>
                        <td class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td class="Pedagogica">Pedagógica<br><span class="grupo"></span></td>					
                        <td class="clase tec-dig"><a href="TecDig.html" target="_blank">Tec. Dig<br><span class="grupo">4to C</span></a></td>
                        <td rowspan="5" class="recreo">Recreo</td>
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM<br><span class="grupo">4to B</span></a></td>
                        <td class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td rowspan="5" class="almuerzo">Almuerzo</td>
                        <td colspan="2" class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD<br><span class="grupo">4to B</span></a></td>
                    </tr>
                    <tr>
                        <td class="dia">Mar</td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>				
                        <td class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>							
                        <td class="clase taller"><a href="Talleres.html" target="_blank">Taller<br><span class="grupo">3ro A</span></a></td>
                        <td class="clase imadsi"><a href="IMASI.html" target="_blank">IMASI<br><span class="grupo">6to</span></a></td>
                        <td class="clase tec-dig"><a href="TecDig.html" target="_blank">Tec. Dig<br><span class="grupo">4to C</span></a></td>
                    </tr>
                    <tr>
                        <td class="dia">Mi</td>
                        <td class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD-CALIG<br><span class="grupo">4to B</span></a></td>
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>	
                        <td class="clase imadsi"><a href="IMASI.html" target="_blank">IMASI<br><span class="grupo">6to I</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>	
                        <td class="clase tec-dig"><a href="TecDig.html" target="_blank">Tec. Dig<br><span class="grupo">4to C</span></a></td>		
                        <td class="clase taller"><a href="Talleres.html" target="_blank">Taller<br><span class="grupo">3ro B</span></a></td>
                         </tr>
                    <tr>
                        <td class="dia">Jue</td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>	
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>
                        <td colspan="2" class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD<br><span class="grupo">4to B</span></a></td>
                    </tr>
                    <tr>
                        <td class="dia">Vie</td>
                        <td class="clase Pedagogica">Pedagógica<br><span class="grupo"></span></td>
                        <td class="clase imadsi"><a href="IMASI.html" target="_blank">IMASI<br><span class="grupo">6to</span></a></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD<br><span class="grupo">4to B</span></a></td>
                        <td class="clase Pedagogica">Pedagógica<br<span class="grupo"></span></td>
                        <td class="clase desarrollo-app"><a href="DASI.html" target="_blank">DASI<br><span class="grupo">5to I</span></a></td>
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM<br><span class="grupo">4to B</span></a></td>
                        <td class="clase diseno-bd"><a href="DDBD.html" target="_blank">DDBD-VPS<br><span class="grupo">4to B</span></a></td>
                        <td class="clase diseno-web"><a href="DPWRM.html" target="_blank">DPWRM-VPS<br><span class="grupo">4to B</span></a></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p>Carga horaria: 29 horas de Clases</p>
    </div>

    <script>
        // Mapeo de índices de celdas para cada día, considerando rowspans y colspans.
        // El índice es 0-based dentro de la colección de <td> para cada <tr>.
        // [P1, P2, P3, P4, P5, P6, P7, P8]
        const periodCellMap = {
            0: [1, 2, 3, 5, 6, 8, 8, 9], // Lun: P6/P7 en índice 8. P4, P5 saltan Recreo(4). P8 en 9.
            1: [1, 2, 3, 4, 5, 6, 7, 8], // Mar: P4/P5 no saltan Recreo. P6-P8 son 6, 7, 8.
            2: [1, 2, 3, 4, 5, 6, 7, 8], // Mi: Igual que Mar.
            3: [1, 2, 3, 4, 5, 6, 6, 7], // Jue: P6/P7 en índice 6. P8 en 7.
            4: [1, 2, 3, 4, 5, 6, 7, 8], // Vie: Igual que Mar.
        };

        // Definición de los intervalos de tiempo y sus correspondientes períodos.
        const periods = [
            { start: "08:00", end: "08:50", period: 1, name: "Clase 1" },
            { start: "08:50", end: "09:40", period: 2, name: "Clase 2" },
            { start: "09:40", end: "10:30", period: 3, name: "Clase 3" },
            { start: "10:30", end: "11:00", period: "Recreo", name: "Recreo" }, // Receso
            { start: "11:00", end: "11:45", period: 4, name: "Clase 4" },
            { start: "11:45", end: "12:30", period: 5, name: "Clase 5" },
            { start: "12:30", end: "13:30", period: "Almuerzo", name: "Almuerzo" }, // Almuerzo
            { start: "13:30", end: "14:20", period: 6, name: "Clase 6" },
            { start: "14:20", end: "15:10", period: 7, name: "Clase 7" },
            { start: "15:10", end: "16:00", period: 8, name: "Clase 8" }
        ];

        // Elementos DOM para actualización
        const scheduleBody = document.querySelector('.horario-clases tbody');
        const countdownBannerEl = document.getElementById('countdown-banner');
        const metadataEl = document.querySelector('.metadata');
        
        // Función auxiliar para convertir tiempo HH:MM a minutos totales desde medianoche
        function timeToMinutes(time) {
            const [hours, minutes] = time.split(':').map(Number);
            return (hours * 60) + minutes;
        }

        // Función para obtener el nombre de la asignatura de una celda
        function getSubjectName(targetCell) {
            // Si la celda contiene un enlace, extraemos el texto del enlace.
            const link = targetCell.querySelector('a');
            if (link) {
                // El contenido principal (e.g., DASI, DDBD) es el primer nodo de texto dentro del enlace
                const subject = link.firstChild.textContent.trim();
                return subject || "Asignatura";
            }
            // Si no hay enlace, volvemos a la lógica original.
            const subject = targetCell.firstChild.textContent.trim();
            return subject || "Asignatura";
        }

        // Función para limpiar el resaltado de la clase activa
        function clearActiveClasses() {
            document.querySelectorAll('.clase-activa').forEach(el => {
                el.classList.remove('clase-activa');
                el.classList.remove('on-break');
            });
        }

        /**
         * Verifica la hora actual y resalta la clase correspondiente.
         */
        function checkCurrentClass() {
            clearActiveClasses();

            const now = new Date();
            const currentDayIndex = now.getDay() - 1; // 0=Lun, 1=Mar, etc.
            const currentTotalMinutes = (now.getHours() * 60) + now.getMinutes();

            // Si es fin de semana o fuera del horario de clases, no hacemos nada más.
            if (currentDayIndex < 0 || currentDayIndex > 4) return;

            // Busca el período actual
            const currentPeriod = periods.find(p => {
                const startMins = timeToMinutes(p.start);
                const endMins = timeToMinutes(p.end);
                // Si la hora actual está entre el inicio y el fin del período
                return currentTotalMinutes >= startMins && currentTotalMinutes < endMins;
            });

            if (currentPeriod) {
                const currentRow = scheduleBody.rows[currentDayIndex];
                let cellIndex = -1;
                let isBreak = false;

                if (currentPeriod.period === "Recreo") {
                    cellIndex = 4; // Índice absoluto de Recreo en la fila de Lun (rowspan cell)
                    isBreak = true;
                } else if (currentPeriod.period === "Almuerzo") {
                    cellIndex = 7; // Índice absoluto de Almuerzo en la fila de Lun (rowspan cell)
                    isBreak = true;
                } else {
                    // Períodos de Clase (1-8)
                    const logicalPeriod = currentPeriod.period;
                    const rowMap = periodCellMap[currentDayIndex];
                    // El array rowMap contiene los índices de celda (columna) <td>
                    // [P1, P2, P3, P4, P5, P6, P7, P8]
                    // El índice real de la celda es rowMap[logicalPeriod - 1]
                    cellIndex = rowMap[logicalPeriod - 1]; 
                }

                // 4. Aplicar el resaltado
                if (cellIndex !== -1) {
                    if (isBreak) {
                        // Para Recreo y Almuerzo, resaltamos la celda maestra de la fila de Lun
                        // Es la única celda visible que tiene el rowspan
                        const breakCell = scheduleBody.rows[0].getElementsByTagName('td')[cellIndex];
                        if (breakCell) breakCell.classList.add('clase-activa');
                    } else {
                        // Para clases regulares, usamos el índice relativo a la fila actual
                        const targetCell = currentRow.getElementsByTagName('td')[cellIndex];
                        if (targetCell) {
                            targetCell.classList.add('clase-activa');
                        }
                    }
                } 
            }
        }

        // Función auxiliar para convertir tiempo HH:MM a segundos totales desde medianoche
        function timeToSeconds(time) {
            const [hours, minutes] = time.split(':').map(Number);
            return (hours * 3600) + (minutes * 60);
        }

        /**
         * Actualiza el párrafo de metadatos con la fecha y hora actual.
         */
        function updateMetadata() {
            const now = new Date();
            // Uso de toLocaleTimeString con opciones para obtener la hora local y segundos
            const time = now.toLocaleTimeString('es-DO', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const date = now.toLocaleDateString('es-DO', { day: '2-digit', month: '2-digit', year: 'numeric' });
            metadataEl.innerHTML = `Profesor: Jorge Luis Abreu, M.A. | Hoy: ${date} | Hora Actual: ${time}`;
        }

        /**
         * Calcula y actualiza el contador para la siguiente transición (inicio/fin de clase).
         */
        function updateCountdown() {
            const now = new Date();
            const currentDayIndex = now.getDay() - 1; // 0=Lun, 1=Mar, etc.
            const currentTotalSeconds = (now.getHours() * 3600) + (now.getMinutes() * 60) + now.getSeconds();

            // Si es fin de semana o fuera del rango 8:00 - 16:00, mostramos mensaje de fin de día.
            if (currentDayIndex < 0 || currentDayIndex > 4 || currentTotalSeconds < timeToSeconds(periods[0].start)) {
                countdownBannerEl.innerHTML = "¡Fin de semana! Disfrute su descanso.";
                countdownBannerEl.classList.remove('on-break');
                return;
            }

            // Busca el evento actual y el siguiente
            let currentPeriod = null;
            let nextPeriod = null;
            let isEnding = false;

            for (let i = 0; i < periods.length; i++) {
                const p = periods[i];
                const startSecs = timeToSeconds(p.start);
                const endSecs = timeToSeconds(p.end);

                if (currentTotalSeconds >= startSecs && currentTotalSeconds < endSecs) {
                    currentPeriod = p;
                    nextPeriod = periods[i + 1];
                    isEnding = true;
                    break;
                } else if (currentTotalSeconds < startSecs) {
                    // Estamos en tiempo muerto (transición entre períodos o antes de la primera clase)
                    nextPeriod = p;
                    isEnding = false;
                    break;
                }
            }

            // Si el horario ha terminado (después de la última clase)
            if (currentPeriod === periods[periods.length - 1] && currentTotalSeconds >= timeToSeconds(currentPeriod.end)) {
                countdownBannerEl.innerHTML = "¡Jornada finalizada! Hasta mañana, profesor.";
                countdownBannerEl.classList.remove('on-break');
                return;
            }

            // Determinar tiempo restante y nombre del siguiente evento
            let nextEventTime = null;
            let nextSubjectName = "El día";
            let isBreak = false;
            let message = "";

            if (currentPeriod && isEnding) {
                // El evento actual está terminando (tiempo hasta `currentPeriod.end`)
                nextEventTime = timeToSeconds(currentPeriod.end);
                isBreak = currentPeriod.period === "Recreo" || currentPeriod.period === "Almuerzo";

                let tempCell = null;
                if (isBreak) {
                    // Para recreo/almuerzo, obtenemos el nombre del siguiente período de CLASE para el banner.
                    const nextClassPeriod = nextPeriod ? nextPeriod.period : null;
                    if (nextClassPeriod && nextPeriod.period !== "Almuerzo") {
                        const nextRow = scheduleBody.rows[currentDayIndex];
                        const nextCellIndex = periodCellMap[currentDayIndex][nextClassPeriod - 1];
                        tempCell = nextRow.getElementsByTagName('td')[nextCellIndex];
                        nextSubjectName = getSubjectName(tempCell);
                    } else {
                        nextSubjectName = currentPeriod.name; // Usar el nombre del break
                    }
                    message = `${currentPeriod.name}. Termina en: `;
                } else {
                    // Clase terminando
                    const currentRow = scheduleBody.rows[currentDayIndex];
                    const logicalPeriod = currentPeriod.period;
                    const cellIndex = periodCellMap[currentDayIndex][logicalPeriod - 1];
                    tempCell = currentRow.getElementsByTagName('td')[cellIndex];
                    nextSubjectName = getSubjectName(tempCell);
                    message = `Clase Actual: ${nextSubjectName}. Termina en: `;
                }

            } else if (nextPeriod) {
                // El siguiente evento está por comenzar (tiempo hasta `nextPeriod.start`)
                nextEventTime = timeToSeconds(nextPeriod.start);
                isBreak = nextPeriod.period === "Recreo" || nextPeriod.period === "Almuerzo";

                if (isBreak) {
                    nextSubjectName = nextPeriod.name;
                    message = `El ${nextSubjectName} comienza en: `;
                } else {
                    // Clase comenzando
                    const currentRow = scheduleBody.rows[currentDayIndex];
                    const logicalPeriod = nextPeriod.period;
                    const cellIndex = periodCellMap[currentDayIndex][logicalPeriod - 1];
                    const tempCell = currentRow.getElementsByTagName('td')[cellIndex];
                    nextSubjectName = getSubjectName(tempCell);
                    message = `Próxima Clase: ${nextSubjectName}. Comienza en: `;
                }
            } else {
                // Caso que no debería ocurrir si el horario está completo
                countdownBannerEl.innerHTML = "Preparando la agenda...";
                return;
            }

            // Calcular el tiempo restante
            if (nextEventTime !== null) {
                const totalSecondsLeft = nextEventTime - currentTotalSeconds;

                if (totalSecondsLeft <= 0) {
                    checkCurrentClass(); // Forzar la actualización inmediata del resaltado
                    return;
                }

                const minutesLeft = Math.floor(totalSecondsLeft / 60);
                const secondsLeft = totalSecondsLeft % 60;
                const timeDisplay = `${String(minutesLeft).padStart(2, '0')}:${String(secondsLeft).padStart(2, '0')}`;

                countdownBannerEl.classList.remove('on-break');
                if (isBreak) {
                    countdownBannerEl.classList.add('on-break');
                }

                countdownBannerEl.innerHTML = `${message} <span>${timeDisplay}</span>`;

            } else {
                countdownBannerEl.innerHTML = "¡Jornada finalizada! Hasta mañana, profesor.";
            }

        }

        // Ejecutar las funciones al cargar la página y establecer el intervalo de actualización
        window.onload = function() {
            updateMetadata();
            checkCurrentClass();
            updateCountdown();
            
            // Actualizar la hora en metadata y el contador cada segundo
            setInterval(() => {
                updateMetadata();
                updateCountdown();
            }, 1000); 

            // Verificar la clase activa cada 30 segundos (suficiente para transiciones de minuto)
            setInterval(checkCurrentClass, 30000); 
        };
    </script>
</body>

</html>





